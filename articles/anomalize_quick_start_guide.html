<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="anomalize">
<title>Anomalize Quick Start Guide • anomalize</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Anomalize Quick Start Guide">
<meta property="og:description" content="anomalize">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">anomalize</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/anomalize_methods.html">Anomalize Methods</a>
    <a class="dropdown-item" href="../articles/anomalize_quick_start_guide.html">Anomalize Quick Start Guide</a>
    <a class="dropdown-item" href="../articles/forecasting_with_cleaned_anomalies.html">Reduce Forecast Error with Cleaned Anomalies</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/business-science/anomalize/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Anomalize Quick Start Guide</h1>
                        <h4 data-toc-skip class="author">Business
Science</h4>
            
            <h4 data-toc-skip class="date">2023-12-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/business-science/anomalize/blob/HEAD/vignettes/anomalize_quick_start_guide.Rmd" class="external-link"><code>vignettes/anomalize_quick_start_guide.Rmd</code></a></small>
      <div class="d-none name"><code>anomalize_quick_start_guide.Rmd</code></div>
    </div>

    
    
<p>The <code>anomalize</code> package is a feature rich package for
performing anomaly detection. It’s geared towards time series analysis,
which is one of the biggest needs for understanding when anomalies
occur. We have a quick start section called “5-Minutes to Anomalize” for
those looking to jump right in. We also have a detailed section on
parameter adjustment for those looking to understand what nobs they can
turn. Finally, for those really looking to get under the hood, we have
another vignette called “Anomalize Methods” that gets into a deep
discussion on STL, Twitter, IQR and GESD methods that are used to power
<code>anomalize</code>.</p>
<div class="section level3">
<h3 id="anomalize-intro-on-youtube">Anomalize Intro on YouTube<a class="anchor" aria-label="anchor" href="#anomalize-intro-on-youtube"></a>
</h3>
<p>As a first step, you may wish to watch our <code>anomalize</code>
introduction video on YouTube.</p>
<p><a href="https://www.youtube.com/watch?v=Gk_HwjhlQJs" target="_blank" class="external-link"><img src="http://img.youtube.com/vi/Gk_HwjhlQJs/0.jpg" alt="Anomalize" width="100%" height="350"></a></p>
<p>Check out our entire <a href="https://www.youtube.com/watch?v=Gk_HwjhlQJs&amp;list=PLo32uKohmrXsYNhpdwr15W143rX6uMAze" class="external-link">Software
Intro Series</a> on YouTube!</p>
</div>
<div class="section level3">
<h3 id="minutes-to-anomalize">5-Minutes To Anomalize<a class="anchor" aria-label="anchor" href="#minutes-to-anomalize"></a>
</h3>
<p>Load libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/tibbletime" class="external-link">tibbletime</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://business-science.github.io/anomalize/" class="external-link">anomalize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NOTE: timetk now has anomaly detection built in, which </span></span>
<span><span class="co">#  will get the new functionality going forward.</span></span>
<span></span>
<span><span class="va">anomalize</span> <span class="op">&lt;-</span> <span class="fu">anomalize</span><span class="fu">::</span><span class="va"><a href="../reference/anomalize.html">anomalize</a></span></span>
<span><span class="va">plot_anomalies</span> <span class="op">&lt;-</span> <span class="fu">anomalize</span><span class="fu">::</span><span class="va"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span></span></code></pre></div>
<p>Get some data. We’ll use the <code>tidyverse_cran_downloads</code>
data set that comes with <code>anomalize</code>. A few points:</p>
<ul>
<li><p>It’s a <code>tibbletime</code> object (class
<code>tbl_time</code>), which is the object structure that
<code>anomalize</code> works with because it’s time aware! Tibbles
(class <code>tbl_df</code>) will automatically be converted.</p></li>
<li><p>It contains daily download counts on 15 “tidy” packages spanning
2017-01-01 to 2018-03-01. The 15 packages are already grouped for your
convenience.</p></li>
<li><p>It’s all setup and ready to analyze with
<code>anomalize</code>!</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyverse_cran_downloads</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A time tibble: 6,375 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Index:         date</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:        package [15]</span></span></span>
<span><span class="co">#&gt;    date       count package</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2017-01-01   873 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2017-01-02  <span style="text-decoration: underline;">1</span>840 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2017-01-03  <span style="text-decoration: underline;">2</span>495 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2017-01-04  <span style="text-decoration: underline;">2</span>906 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2017-01-05  <span style="text-decoration: underline;">2</span>847 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2017-01-06  <span style="text-decoration: underline;">2</span>756 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2017-01-07  <span style="text-decoration: underline;">1</span>439 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2017-01-08  <span style="text-decoration: underline;">1</span>556 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2017-01-09  <span style="text-decoration: underline;">3</span>678 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2017-01-10  <span style="text-decoration: underline;">7</span>086 tidyr  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6,365 more rows</span></span></span></code></pre></div>
<p>We can use the general workflow for anomaly detection, which involves
three main functions:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/time_decompose.html">time_decompose()</a></code>: Separates the time series into
seasonal, trend, and remainder components</li>
<li>
<code><a href="../reference/anomalize.html">anomalize()</a></code>: Applies anomaly detection methods to the
remainder component.</li>
<li>
<code><a href="../reference/time_recompose.html">time_recompose()</a></code>: Calculates limits that separate the
“normal” data from the anomalies!</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyverse_cran_downloads_anomalized</span> <span class="op">&lt;-</span> <span class="va">tidyverse_cran_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span>, merge <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span></span>
<span><span class="va">tidyverse_cran_downloads_anomalized</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 6,375</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; Index: date</span></span>
<span><span class="co">#&gt; Groups: package [15]</span></span>
<span><span class="co">#&gt; $ package       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "broom", "broom", "broom", "broom", "broom", "broom", "b…</span></span>
<span><span class="co">#&gt; $ date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2017-01-01, 2017-01-02, 2017-01-03, 2017-01-04, 2017-01…</span></span>
<span><span class="co">#&gt; $ count         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1053, 1481, 1851, 1947, 1927, 1948, 1542, 1479, 2057, 22…</span></span>
<span><span class="co">#&gt; $ observed      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.053000e+03, 1.481000e+03, 1.851000e+03, 1.947000e+03, …</span></span>
<span><span class="co">#&gt; $ season        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1006.9759, 339.6028, 562.5794, 526.0532, 430.1275, 136.…</span></span>
<span><span class="co">#&gt; $ trend         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1708.465, 1730.742, 1753.018, 1775.294, 1797.571, 1819.8…</span></span>
<span><span class="co">#&gt; $ remainder     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 351.510801, -589.344328, -464.597345, -354.347509, -300.…</span></span>
<span><span class="co">#&gt; $ remainder_l1  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1724.778, -1724.778, -1724.778, -1724.778, -1724.778, -…</span></span>
<span><span class="co">#&gt; $ remainder_l2  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1704.371, 1704.371, 1704.371, 1704.371, 1704.371, 1704.3…</span></span>
<span><span class="co">#&gt; $ anomaly       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "No", "No", "No", "No", "No", "No", "No", "No", "No", "N…</span></span>
<span><span class="co">#&gt; $ recomposed_l1 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1023.2887, 345.5664, 590.8195, 576.5696, 502.9204, 231.…</span></span>
<span><span class="co">#&gt; $ recomposed_l2 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2405.860, 3774.715, 4019.968, 4005.718, 3932.069, 3660.4…</span></span></code></pre></div>
<p>Let’s explain what happened:</p>
<ol style="list-style-type: decimal">
<li>
<code>time_decompose(count, merge = TRUE)</code>: This performs a
time series decomposition on the “count” column using seasonal
decomposition. It created four columns:
<ul>
<li>“observed”: The observed values (actuals)</li>
<li>“season”: The seasonal or cyclic trend. The default for daily data
is a weekly seasonality.</li>
<li>“trend”: This is the long term trend. The default is a Loess
smoother using spans of 3-months for daily data.</li>
<li>“remainder”: This is what we want to analyze for outliers. It is
simply the observed minus both the season and trend.</li>
<li>Setting <code>merge = TRUE</code> keeps the original data with the
newly created columns.</li>
</ul>
</li>
<li>
<code>anomalize(remainder)</code>: This performs anomaly detection
on the remainder column. It creates three new columns:
<ul>
<li>“remainder_l1”: The lower limit of the remainder</li>
<li>“remainder_l2”: The upper limit of the remainder</li>
<li>“anomaly”: Yes/No telling us whether or not the observation is an
anomaly</li>
</ul>
</li>
<li>
<code><a href="../reference/time_recompose.html">time_recompose()</a></code>: This recomposes the season, trend and
remainder_l1 and remainder_l2 columns into new limits that bound the
observed values. The two new columns created are:
<ul>
<li>“recomposed_l1”: The lower bound of outliers around the observed
value</li>
<li>“recomposed_l2”: The upper bound of outliers around the observed
value</li>
</ul>
</li>
</ol>
<p>We can then visualize the anomalies using the
<code><a href="../reference/plot_anomalies.html">plot_anomalies()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyverse_cran_downloads_anomalized</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, alpha_dots <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="parameter-adjustment">Parameter Adjustment<a class="anchor" aria-label="anchor" href="#parameter-adjustment"></a>
</h3>
<p>Now that you have an overview of the package, you can begin to adjust
the parameter settings. The first settings you may wish to explore are
related to time series decomposition: trend and seasonality. The second
are related to anomaly detection: alpha and max anoms.</p>
<div class="section level4">
<h4 id="adjusting-decomposition-trend-and-seasonality">Adjusting Decomposition Trend and Seasonality<a class="anchor" aria-label="anchor" href="#adjusting-decomposition-trend-and-seasonality"></a>
</h4>
<p>Adjusting the trend and seasonality are fundamental to time series
analysis and specifically time series decomposition. With
<code>anomalize</code>, it’s simple to make adjustments because
everything is done with date or datetime information so you can
intuitively select increments by time spans that make sense (e.g. “5
minutes” or “1 month”).</p>
<p>To get started, let’s isolate one of the time series packages:
lubridate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lubridate_daily_downloads</span> <span class="op">&lt;-</span> <span class="va">tidyverse_cran_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">package</span> <span class="op">==</span> <span class="st">"lubridate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lubridate_daily_downloads</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A time tibble: 425 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Index:         date</span></span></span>
<span><span class="co">#&gt;    date       count package  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2017-01-01   643 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2017-01-02  <span style="text-decoration: underline;">1</span>350 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2017-01-03  <span style="text-decoration: underline;">2</span>940 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2017-01-04  <span style="text-decoration: underline;">4</span>269 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2017-01-05  <span style="text-decoration: underline;">3</span>724 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2017-01-06  <span style="text-decoration: underline;">2</span>326 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2017-01-07  <span style="text-decoration: underline;">1</span>107 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2017-01-08  <span style="text-decoration: underline;">1</span>058 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2017-01-09  <span style="text-decoration: underline;">2</span>494 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2017-01-10  <span style="text-decoration: underline;">3</span>237 lubridate</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 415 more rows</span></span></span></code></pre></div>
<p>Next, let’s perform anomaly detection.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lubridate_daily_downloads_anomalized</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 91 days</span></span>
<span></span>
<span><span class="va">lubridate_daily_downloads_anomalized</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 425</span></span>
<span><span class="co">#&gt; Columns: 10</span></span>
<span><span class="co">#&gt; Index: date</span></span>
<span><span class="co">#&gt; $ date          <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 2017-01-01, 2017-01-02, 2017-01-03, 2017-01-04, 2017-01…</span></span>
<span><span class="co">#&gt; $ observed      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 6.430000e+02, 1.350000e+03, 2.940000e+03, 4.269000e+03, …</span></span>
<span><span class="co">#&gt; $ season        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -2077.6548, 517.9370, 1117.0490, 1219.5377, 865.1171, 35…</span></span>
<span><span class="co">#&gt; $ trend         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2474.491, 2491.126, 2507.761, 2524.397, 2541.032, 2557.6…</span></span>
<span><span class="co">#&gt; $ remainder     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 246.1636, -1659.0632, -684.8105, 525.0657, 317.8511, -58…</span></span>
<span><span class="co">#&gt; $ remainder_l1  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -3323.425, -3323.425, -3323.425, -3323.425, -3323.425, -…</span></span>
<span><span class="co">#&gt; $ remainder_l2  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3310.268, 3310.268, 3310.268, 3310.268, 3310.268, 3310.2…</span></span>
<span><span class="co">#&gt; $ anomaly       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "No", "No", "No", "No", "No", "No", "No", "No", "No", "N…</span></span>
<span><span class="co">#&gt; $ recomposed_l1 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -2926.58907, -314.36218, 301.38509, 420.50889, 82.72349,…</span></span>
<span><span class="co">#&gt; $ recomposed_l2 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3707.105, 6319.331, 6935.079, 7054.202, 6716.417, 6223.8…</span></span></code></pre></div>
<p>First, notice that a <code>frequency</code> and a <code>trend</code>
were automatically selected for us. This is by design. The arguments
<code>frequency = "auto"</code> and <code>trend = "auto"</code> are the
defaults. We can visualize this decomposition using
<code><a href="../reference/plot_anomaly_decomposition.html">plot_anomaly_decomposition()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads_anomalized</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomaly_decomposition.html">plot_anomaly_decomposition</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Freq/Trend = 'auto'"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>When “auto” is used, a <code><a href="../reference/time_scale_template.html">get_time_scale_template()</a></code> is used
to determine logical frequency and trend spans based on the scale of the
data. You can uncover the logic:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/time_scale_template.html">get_time_scale_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt;   time_scale frequency trend   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> second     1 hour    12 hours</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> minute     1 day     14 days </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> hour       1 day     1 month </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> day        1 week    3 months</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> week       1 quarter 1 year  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> month      1 year    5 years </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> quarter    1 year    10 years</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> year       5 years   30 years</span></span></code></pre></div>
<p>What this means is that if the scale is 1 day (meaning the difference
between each data point is 1 day), then the frequency will be 7 days (or
1 week) and the trend will be around 90 days (or 3 months). This logic
tends to work quite well for anomaly detection, but you may wish to
adjust it. There are two ways:</p>
<ol style="list-style-type: decimal">
<li>Local parameter adjustment</li>
<li>Global parameter adjustment</li>
</ol>
<div class="section level5">
<h5 id="local-parameter-adjustment">Local Parameter Adjustment<a class="anchor" aria-label="anchor" href="#local-parameter-adjustment"></a>
</h5>
<p>Local parameter adjustment can be performed by tweaking the
in-function parameters. Below we adjust <code>trend = "14 days"</code>
which makes for a quite overfit trend.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Local adjustment via time_decompose</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span>,</span>
<span>                   frequency <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                   trend     <span class="op">=</span> <span class="st">"14 days"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomaly_decomposition.html">plot_anomaly_decomposition</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Trend = 14 Days (Local)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 14 days</span></span>
<span></span>
<span><span class="co"># Show plots</span></span>
<span><span class="va">p1</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="global-parameter-adjustement">Global Parameter Adjustement<a class="anchor" aria-label="anchor" href="#global-parameter-adjustement"></a>
</h5>
<p>We can also adjust globally by using
<code><a href="../reference/time_scale_template.html">set_time_scale_template()</a></code> to update the default template to
one that we prefer. We’ll change the “3 month” trend to “2 weeks” for
time scale = “day”. Use <code><a href="../reference/time_scale_template.html">time_scale_template()</a></code> to retrieve
the time scale template that <code>anomalize</code> begins with, them
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> the trend field in the desired location, and use
<code><a href="../reference/time_scale_template.html">set_time_scale_template()</a></code> to update the template in the
global options. We can retrieve the updated template using
<code><a href="../reference/time_scale_template.html">get_time_scale_template()</a></code> to verify the change has been
executed properly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Globally change time scale template options</span></span>
<span><span class="fu"><a href="../reference/time_scale_template.html">time_scale_template</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">time_scale</span> <span class="op">==</span> <span class="st">"day"</span>, <span class="st">"14 days"</span>, <span class="va">trend</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_scale_template.html">set_time_scale_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/time_scale_template.html">get_time_scale_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt;   time_scale frequency trend   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> second     1 hour    12 hours</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> minute     1 day     14 days </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> hour       1 day     1 month </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> day        1 week    14 days </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> week       1 quarter 1 year  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> month      1 year    5 years </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> quarter    1 year    10 years</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> year       5 years   30 years</span></span></code></pre></div>
<p>Finally we can re-run the <code><a href="../reference/time_decompose.html">time_decompose()</a></code> with
defaults, and we can see that the trend is “14 days”.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomaly_decomposition.html">plot_anomaly_decomposition</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Trend = 14 Days (Global)"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 14 days</span></span>
<span></span>
<span><span class="va">p3</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Let’s reset the time scale template defaults back to the original
defaults.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set time scale template to the original defaults</span></span>
<span><span class="fu"><a href="../reference/time_scale_template.html">time_scale_template</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_scale_template.html">set_time_scale_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify the change</span></span>
<span><span class="fu"><a href="../reference/time_scale_template.html">get_time_scale_template</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 3</span></span></span>
<span><span class="co">#&gt;   time_scale frequency trend   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> second     1 hour    12 hours</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> minute     1 day     14 days </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> hour       1 day     1 month </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> day        1 week    3 months</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> week       1 quarter 1 year  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> month      1 year    5 years </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> quarter    1 year    10 years</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> year       5 years   30 years</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="adjusting-anomaly-detection-alpha-and-max-anoms">Adjusting Anomaly Detection Alpha and Max Anoms<a class="anchor" aria-label="anchor" href="#adjusting-anomaly-detection-alpha-and-max-anoms"></a>
</h4>
<p>The <code>alpha</code> and <code>max_anoms</code> are the two
parameters that control the <code><a href="../reference/anomalize.html">anomalize()</a></code> function. Here’s
how they work.</p>
<div class="section level5">
<h5 id="alpha">Alpha<a class="anchor" aria-label="anchor" href="#alpha"></a>
</h5>
<p>We can adjust <code>alpha</code>, which is set to 0.05 by default. By
default the bands just cover the outside of the range.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, max_anoms <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span><span class="op">(</span>time_recomposed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"alpha = 0.05"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 91 days</span></span>
<span></span>
<span><span class="va">p4</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can decrease <code>alpha</code>, which increases the bands making
it more difficult to be an outlier. See that the bands doubled in
size.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, max_anoms <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span><span class="op">(</span>time_recomposed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"alpha = 0.025"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 91 days</span></span>
<span></span>
<span><span class="va">p4</span> </span>
<span><span class="va">p5</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="max-anoms">Max Anoms<a class="anchor" aria-label="anchor" href="#max-anoms"></a>
</h5>
<p>The <code>max_anoms</code> parameter is used to control the maximum
percentage of data that can be an anomaly. This is useful in cases where
<code>alpha</code> is too difficult to tune, and you really want to
focus on the most aggregious anomalies.</p>
<p>Let’s adjust <code>alpha = 0.3</code> so pretty much anything is an
outlier. Now let’s try a comparison between <code>max_anoms = 0.2</code>
(20% anomalies allowed) and <code>max_anoms = 0.05</code> (5% anomalies
allowed).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, max_anoms <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span><span class="op">(</span>time_recomposed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"20% Anomalies"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 91 days</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="va">lubridate_daily_downloads</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_decompose.html">time_decompose</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/anomalize.html">anomalize</a></span><span class="op">(</span><span class="va">remainder</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, max_anoms <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/time_recompose.html">time_recompose</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/plot_anomalies.html">plot_anomalies</a></span><span class="op">(</span>time_recomposed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"5% Anomalies"</span><span class="op">)</span></span>
<span><span class="co">#&gt; frequency = 7 days</span></span>
<span><span class="co">#&gt; trend = 91 days</span></span>
<span></span>
<span><span class="va">p6</span></span>
<span><span class="va">p7</span></span></code></pre></div>
<p><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-14-1.png" width="700"><img src="anomalize_quick_start_guide_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<p>In reality, you’ll probably want to leave <code>alpha</code> in the
range of 0.10 to 0.02, but it makes a nice illustration of how you can
also use <code>max_anoms</code> to ensure only the most aggregious
anomalies are identified.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="further-understanding-methods">Further Understanding: Methods<a class="anchor" aria-label="anchor" href="#further-understanding-methods"></a>
</h3>
<p>If you haven’t had your fill and want to dive into the methods that
power anomalize, check out the vignette, “Anomalize Methods”.</p>
</div>
<div class="section level2">
<h2 id="interested-in-learning-anomaly-detection">Interested in Learning Anomaly Detection?<a class="anchor" aria-label="anchor" href="#interested-in-learning-anomaly-detection"></a>
</h2>
<p>Business Science offers two 1-hour courses on Anomaly Detection:</p>
<ul>
<li><p><a href="https://university.business-science.io/p/learning-labs-pro" class="external-link">Learning
Lab 18</a> - Time Series Anomaly Detection with
<code>anomalize</code></p></li>
<li><p><a href="https://university.business-science.io/p/learning-labs-pro" class="external-link">Learning
Lab 17</a> - Anomaly Detection with <code>H2O</code> Machine
Learning</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matt Dancho, Davis Vaughan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
